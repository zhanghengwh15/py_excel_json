# 变更日志

## [2.0.0] - 2024-12-01

### 🚀 新增功能

#### 用户菜单权限批量导出
- **新增**: 通过API批量获取用户列表功能
- **新增**: 批量获取每个用户的菜单权限详情功能
- **新增**: 用户菜单权限数据合并导出到Excel功能
- **新增**: 相同用户的Excel单元格自动合并功能
- **新增**: 详细的统计信息显示功能

#### API请求优化
- **新增**: 用户列表分页获取支持（pageNum从1开始）
- **新增**: 智能请求间隔控制
  - 用户列表请求：200ms间隔
  - 菜单权限请求：300ms间隔
- **新增**: 自动分页终止条件（data为空时停止）

#### 文件结构优化
- **新增**: `user_menu_export.py` - 专用用户权限导出脚本
- **新增**: `test_api.py` - API功能测试脚本
- **新增**: `CHANGELOG.md` - 变更日志文档

### 🔧 技术改进

#### 代码架构
- **重构**: `JsonToExcelConverter` 类增加用户权限处理方法
- **新增**: `get_user_list()` - 支持分页的用户列表获取
- **新增**: `get_user_menu_permissions()` - 用户菜单权限获取
- **新增**: `parse_user_menu_data()` - 用户菜单数据解析
- **新增**: `batch_process_user_permissions()` - 批量处理用户权限
- **新增**: `_merge_user_cells()` - Excel单元格合并功能

#### Excel输出增强
- **新增**: 支持用户权限数据的Excel导出
- **新增**: 四列格式：用户名称、菜单名称、菜单层级、类型
- **新增**: 用户名称列自动合并功能
- **新增**: 边框样式和居中对齐
- **新增**: 自定义文件名前缀支持

### 📚 文档更新

#### 新增文档
- **新增**: `QUICK_START.md` - 快速开始指南
- **新增**: `CHANGELOG.md` - 变更日志
- **更新**: `README.md` - 完整功能说明
- **更新**: `requirements.txt` - 添加requests依赖

#### 文档内容
- **新增**: 用户权限批量导出使用说明
- **新增**: API配置参数获取方法
- **新增**: 分页和间隔功能说明
- **新增**: 故障排除指南
- **新增**: 常见问题解答

### 🐛 修复问题

#### 基础功能
- **修复**: JSON数据解析的边界条件处理
- **修复**: Excel文件生成的异常处理
- **修复**: 编码格式兼容性问题

### ⚠️ 重要变更

#### 依赖更新
- **新增**: `requests>=2.25.0` - HTTP请求库
- **保持**: `pandas>=1.5.0` - 数据处理
- **保持**: `openpyxl>=3.0.0` - Excel文件处理

#### 配置要求
- **新增**: API认证参数配置要求
- **新增**: 网络连接和权限要求
- **新增**: 请求间隔控制要求

### 📋 使用说明

#### 新功能使用
1. **配置API参数**: 在 `user_menu_export.py` 中配置正确的API参数
2. **运行批量导出**: `python user_menu_export.py`
3. **查看结果**: 生成的Excel文件包含用户权限数据

#### 兼容性
- **保持**: 原有的JSON转Excel功能完全兼容
- **新增**: 用户权限批量导出功能独立运行
- **支持**: 两种功能可以同时使用

### 🔮 未来计划

#### 计划功能
- [ ] 支持更多API接口
- [ ] 增加数据缓存功能
- [ ] 支持增量更新
- [ ] 增加Web界面
- [ ] 支持更多Excel格式

#### 性能优化
- [ ] 并发请求支持
- [ ] 内存使用优化
- [ ] 大文件处理优化
- [ ] 错误重试机制

---

## [1.0.0] - 2024-11-30

### 🎉 初始版本

#### 基础功能
- **新增**: JSON菜单数据转Excel功能
- **新增**: 多层级菜单结构支持
- **新增**: 菜单类型自动识别
- **新增**: Excel格式美化
- **新增**: 时间戳文件名生成

#### 核心特性
- 递归解析JSON数据
- 完整菜单路径显示
- 菜单/功能类型区分
- 标题行格式美化
- 不同类型颜色区分 