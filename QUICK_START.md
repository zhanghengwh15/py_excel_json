# 快速开始指南

## 🚀 5分钟快速上手

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 功能选择

#### 功能A：JSON菜单数据转Excel
如果你有JSON格式的菜单数据需要转换为Excel：

```bash
# 使用示例数据测试
python json_to_excel.py

# 使用自己的JSON文件
python json_to_excel.py your_menu_data.json
```

#### 功能B：批量导出用户菜单权限
如果你需要批量获取用户列表和对应的菜单权限：

```bash
# 第一步：配置参数（重要！）
# 编辑 user_menu_export.py 文件，修改以下配置：
# - token: 你的认证令牌
# - userId: 你的用户ID
# - orgId: 组织ID
# - eid: 企业ID
# - uid: 用户唯一标识

# 第二步：运行导出
python user_menu_export.py
```

## 📋 获取配置参数的方法

### 步骤1：登录系统
在浏览器中登录你的管理系统

### 步骤2：打开开发者工具
- 按 F12 键
- 或右键选择"检查"

### 步骤3：找到Network选项卡
点击开发者工具中的"Network"（网络）选项卡

### 步骤4：执行用户管理操作
在系统中执行一次用户管理相关的操作（如查看用户列表）

### 步骤5：查看请求详情
在Network选项卡中找到用户相关的API请求，点击查看：
- **Headers**选项卡中的请求头包含：token、userId、orgId等
- **Payload**选项卡中的请求体包含：eid、uid等

### 步骤6：复制参数
将这些参数复制到 `user_menu_export.py` 文件的配置区域

## 📊 输出结果

### JSON转Excel输出
- 文件名：`yyyyMMddHHmm.xlsx`（如：202412011430.xlsx）
- 内容：菜单名称、菜单层级、类型

### 用户权限导出输出  
- 文件名：`用户菜单权限_yyyyMMddHHmm.xlsx`
- 内容：用户名称、菜单名称、菜单层级、类型
- 特色：相同用户的行会自动合并
- 分页：自动处理大量用户数据，支持分页获取
- 间隔：用户列表请求间隔200ms，菜单权限请求间隔300ms，确保API稳定性

## ❓ 常见问题

### Q: token过期了怎么办？
A: 重新登录系统，按照上述步骤获取新的token

### Q: 为什么获取不到用户数据？
A: 检查以下几点：
1. token是否正确且有效
2. 用户ID是否有权限访问
3. 网络连接是否正常
4. 配置参数是否完整

### Q: Excel文件在哪里？
A: 生成的Excel文件保存在项目根目录中

### Q: 可以修改输出格式吗？
A: 可以编辑 `json_to_excel.py` 文件自定义输出格式

## 🔧 故障排除

如果遇到问题，请检查：

1. **Python版本**：确保使用Python 3.7+
2. **依赖安装**：运行 `pip list` 查看是否安装了所需依赖
3. **网络连接**：确保能够访问API接口
4. **权限配置**：确保用户有足够的权限访问数据
5. **参数配置**：检查所有必填参数是否正确配置

## 📞 获取帮助

如需更多帮助，请查看：
- `README.md` - 详细文档
- 代码注释 - 详细的函数说明
- 控制台输出 - 错误信息和调试信息 