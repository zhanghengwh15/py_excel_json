# 酒鬼窖池历史数据生成器

## 功能说明

这个工具用于生成酒鬼窖池历史数据的测试数据，包含以下特性：

- 🏭 **窖池范围**: 窖池ID 100-110（共11个窖池）
- 📊 **数据量**: 每个sheet 100,000条记录
- 📅 **时间范围**: 1990-2025年
- 🔢 **轮次格式**: 年份-轮次号（如：2025-1）
- 📋 **数据字段**: 包含温度、质量、工艺、原料等完整数据
- 🎨 **Excel格式**: 包含合并单元格的标题行，与模板格式完全一致
- 🏷️ **窖池编码**: 直接使用数字格式（如：100、101、102等）

## 版本说明

### V2版本（generate_wine_cellar_data_v2.py）⭐ **推荐**
- **功能**: 根据Excel模板格式生成三种不同类型的数据
- **数据格式**: 严格按照Excel模板格式生成，包含合并单元格标题
- **输出**: 只有3个sheet，每个sheet包含所有窖池的数据
- **数据类型**:
  1. **投料耗用**: 包含投入日期、轮次、发酵期、各种原料投入和耗用数据
  2. **等级酒生产记录**: 包含原酒分类（Z1、Z2、D1、D2、D3、G）和产量数据
  3. **入窖出窖糟化验记录**: 包含出池和入池化验数据（酸度、淀粉、水分）

## Excel格式说明

### 等级酒生产记录 Sheet
- **第一行**: 合并单元格标题
  - A1: 窖池编号
  - B1: 日期
  - C1: 轮次
  - D1-I1: 原酒（合并单元格）
  - J1: 未折度产量 (kg)
  - K1: 未折度出酒率 (%)
- **第二行**: 子标题
  - A2: 窖池编号
  - B2: 日期
  - C2: 轮次
  - D2: 原酒Z1
  - E2: 原酒Z2
  - F2: 原酒D1
  - G2: 原酒D2
  - H2: 原酒D3
  - I2: 原酒G
  - J2: 未折度产量 (kg)
  - K2: 未折度出酒率 (%)

### 入窖出窖糟化验记录 Sheet
- **第一行**: 合并单元格标题
  - A1: 窖池编号
  - B1: 日期
  - C1-E1: 出池化验数据（合并单元格）
  - F1-H1: 入池化验数据（合并单元格）
- **第二行**: 子标题
  - A2: 窖池编号
  - B2: 日期
  - C2: 酸度
  - D2: 淀粉
  - E2: 水分
  - F2: 酸度
  - G2: 淀粉
  - H2: 水分

### 投料耗用 Sheet
- **单行标题**: 标准格式
  - 包含所有字段的标题行

## 数据字段说明

### V2版本数据字段

#### 投料耗用
- `窖池编号`: 窖池编号（格式：100、101、102等）
- `投入日期`: 投入日期（格式：2023/11/11）
- `轮次`: 轮次编号（格式：2025-1）
- `发酵期(天)`: 发酵期天数
- `糖化粮(投入)`: 糖化粮投入量
- `大曲(投入)`: 大曲投入量
- `熟谷壳(投入)`: 熟谷壳投入量
- `状态`: 状态（投入/耗用/发酵中）
- `糖化粮(耗用)`: 糖化粮耗用量
- `大曲(耗用)`: 大曲耗用量
- `熟谷壳(耗用)`: 熟谷壳耗用量

#### 等级酒生产记录
- `窖池编号`: 窖池编号（格式：100、101、102等）
- `日期`: 记录日期（格式：2023/11/11）
- `轮次`: 轮次编号（格式：2025-1）
- `原酒Z1`: 原酒Z1产量
- `原酒Z2`: 原酒Z2产量
- `原酒D1`: 原酒D1产量
- `原酒D2`: 原酒D2产量
- `原酒D3`: 原酒D3产量
- `原酒G`: 原酒G产量
- `未折度产量 (kg)`: 未折度产量
- `未折度出酒率 (%)`: 未折度出酒率

#### 入窖出窖糟化验记录
- `窖池编号`: 窖池编号（格式：100、101、102等）
- `日期`: 记录日期（格式：2023/11/11）
- `出池化验数据_酸度`: 出池酸度
- `出池化验数据_淀粉`: 出池淀粉
- `出池化验数据_水分`: 出池水分
- `入池化验数据_酸度`: 入池酸度
- `入池化验数据_淀粉`: 入池淀粉
- `入池化验数据_水分`: 入池水分

## 使用方法

### 方法一：使用Shell脚本（推荐）

#### V2版本（推荐）
```bash
# 从项目根目录运行
./run_data_generator_v2.sh

# 或进入data目录运行
cd data
python3 generate_wine_cellar_data_v2.py
```

### 方法二：直接运行Python脚本

#### V2版本
```bash
# 进入data目录
cd data
python3 generate_wine_cellar_data_v2.py
```

### 方法三：从项目根目录运行

```bash
# V2版本
python3 data/generate_wine_cellar_data_v2.py
```

## 输出文件

### V2版本
生成的Excel文件将保存在 `data/` 目录下，文件名格式为：
```
酒鬼窖池历史数据导入_YYYYMMDDHHMM.xlsx
```

Excel文件包含3个工作表：
- `投料耗用`: 包含所有窖池的投料耗用数据
- `等级酒生产记录`: 包含所有窖池的等级酒生产记录（带合并单元格标题）
- `入窖出窖糟化验记录`: 包含所有窖池的化验记录（带合并单元格标题）

每个sheet包含100,000条记录，总计300,000条记录。

## 数据特点

1. **真实性**: 数据范围符合实际生产情况
2. **完整性**: 包含生产过程中的所有关键指标
3. **随机性**: 使用随机数生成，避免数据重复
4. **格式化**: Excel文件包含完整的格式设置
   - 标题行：蓝色背景，白色字体
   - 合并单元格：支持复杂的标题结构
   - 数据行：居中对齐，带边框（前1000行）
   - 列宽：根据内容自动调整
   - 冻结窗格：支持多行标题
5. **大数据量**: 每个sheet 10万条记录，总计30万条记录
6. **长时间跨度**: 数据时间范围从1990年到2025年

## 依赖要求

- Python 3.6+
- pandas
- openpyxl

## 自定义配置

如需修改数据生成参数，可以编辑对应的Python文件中的以下参数：

```python
class WineCellarDataGeneratorV2:
    def __init__(self):
        self.cellar_ids = list(range(100, 111))  # 窖池ID范围
        self.data_count = 100000  # 每个sheet的数据量
```

## 注意事项

1. 生成大量数据可能需要较长时间，请耐心等待
2. 确保有足够的磁盘空间存储生成的Excel文件（约15MB）
3. 生成的Excel文件可以直接用于测试和演示
4. V2版本严格按照Excel模板格式生成，更适合实际使用
5. 每个sheet包含所有窖池的数据，便于统一管理和分析
6. Excel格式包含合并单元格的标题行，与模板格式完全一致
7. 窖池编码使用纯数字格式，去掉前缀
8. 时间范围扩大到1990-2025年，提供更丰富的历史数据

## 故障排除

### 问题1：Python未安装
```bash
# macOS
brew install python3

# Ubuntu/Debian
sudo apt-get install python3
```

### 问题2：依赖包缺失
```bash
pip3 install pandas openpyxl
```

### 问题3：权限问题
```bash
chmod +x run_data_generator_v2.sh
```

### 问题4：内存不足
- 如果生成过程中出现内存不足，可以减少数据量
- 修改 `self.data_count = 100000` 为较小的数值

## 版本信息

- V2版本：2.0.0
- 作者：AI Assistant
- 日期：2024 